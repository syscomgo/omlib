[{"app_name":"OMFLOW CISCO ISE APP","app_attr":"user","language_package":"{\"zh-hant\": {\"OMFLOW CISCO ISE APP\": \"\"}, \"en\": {\"OMFLOW CISCO ISE APP\": \"\"}, \"ja\": {\"OMFLOW CISCO ISE APP\": \"\"}, \"zh-hans\": {\"OMFLOW CISCO ISE APP\": \"\"}}","flow_list":[{"flow_name":"ISE Identity Groups表","description":"","flowobject":{"form_object":{"form_item_counter":4,"form_box_counter":1,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[{"id":"FORMBOX_1","type":"box12","parent":"public","hidden":false,"config":{"idcounter":1,"color":"box box-primary","title":""}},{"id":"FORMITM_1","type":"inputbox","parent":"FORMBOX_1","hidden":false,"config":{"idcounter":1,"title":"Group UUID","require":false,"placeholder":"","type":"text","value":"","regex":"","readonly":false,"mask":false,"mask_head":"0","mask_tail":"0","mask_min":"3","scan":false,"rows":0}},{"id":"FORMITM_2","type":"inputbox","parent":"FORMBOX_1","hidden":false,"config":{"idcounter":2,"title":"Group Name","require":false,"placeholder":"","type":"text","value":"","regex":"","readonly":false,"mask":false,"mask_head":"0","mask_tail":"0","mask_min":"3","scan":false,"rows":0}},{"id":"FORMITM_3","type":"areabox","parent":"FORMBOX_1","hidden":false,"config":{"idcounter":3,"title":"Description","require":false,"rows":"3","value":"","regex":"","readonly":false}},{"id":"FORMITM_4","type":"areabox","parent":"FORMBOX_1","hidden":false,"config":{"idcounter":4,"title":"JSON","require":false,"rows":"9","value":"","regex":"","readonly":false}}],"is_cform":false}},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":true,"name":"ISE Identity Groups表","description":"","api_path":"a8d41d27-8c96-ce85-e647-524d1af03f2e","attachment":false,"relation":false,"worklog":false,"history":true,"api":true,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"","custom_data_no_twy":"","custom_data_no_reset":"day"}},"flow_app_id__app_name":"OMFLOW CISCO ISE APP"},{"flow_name":"掃描ISE Identity Group","description":"","flowobject":{"flow_item_counter":8,"flow_line_counter":11,"form_object":{"form_item_counter":0,"form_box_counter":0,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[],"is_cform":false},"is_sub":false,"subflow":[],"items":[{"id":"FITEM_1","type":"start","text":"開始","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"callable":false,"input":[{"require":false,"value":"success","name":"result","des":""}],"output":[],"subflow_input":[],"subflow_output":[],"top":0,"left":210,"verify":false,"python_input":[{"des":"","name":"status","value":"success"},{"des":"","name":"message","value":""}],"python_output":[{"des":"輸出success則通過，其他則失敗","name":"status","value":"$(status)"},{"des":"","name":"message","value":"$(message)"}],"python_code":"","packages":[]}},{"id":"FITEM_4","type":"end","text":"結束","left":0,"top":0,"config":{"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"top":400,"left":210}},{"id":"FITEM_5","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":null,"name":"ids","des":""},{"require":false,"value":null,"name":"names","des":""},{"require":false,"value":null,"name":"descriptions","des":""},{"require":false,"value":null,"name":"jsons","des":""}],"output":[{"value":"$(ids)","name":"$(ids)","des":""},{"value":"$(names)","name":"$(names)","des":""},{"value":"$(descriptions)","name":"$(descriptions)","des":""},{"value":"$(jsons)","name":"$(jsons)","des":""}],"calculate":[],"packages":[],"code":"#!/usr/bin/env python\n\nimport http.client\nimport base64\nimport ssl\nimport sys\n\n# host and authentication credentials\nhost = \"192.168.1.52\"  # \"10.20.30.40\"\nuser = \"apiadmin\"  # \"ersad\"\npassword = \"3edc$RFV\"  # \"Password1\"\n\n\nconn = http.client.HTTPSConnection(\"{}:9060\".format(host), context=ssl.SSLContext(ssl.PROTOCOL_TLSv1_2))\ncreds = str.encode(':'.join((user, password)))\nencodedAuth = bytes.decode(base64.b64encode(creds))\n\n\nheaders = {\n    'accept': \"application/json\",\n    'content-type': \"application/json\",\n    'authorization': \" \".join((\"Basic\", encodedAuth)),\n    'cache-control': \"no-cache\",\n    }\n\nconn.request(\"GET\", \"/ers/config/identitygroup\", headers=headers)\n\nres = conn.getresponse()\ndata = res.read()\nconn.close()\n\nprint(\"Status: {}\".format(res.status))\n# print(\"Header:\\n{}\".format(res.headers))\nprint(\"Body:\\n{}\".format(data.decode(\"utf-8\")))\n\nids = []\nnames = []\ndescriptions = []\njsons = []\nobjects = eval(data.decode(\"utf-8\"))\n\nfor obj in objects[\"SearchResult\"][\"resources\"]:\n    ids.append(obj['id'])\n    names.append(obj['name'])\n    descriptions.append(obj['description'])\n    jsons.append(str(obj))\n\nids = ','.join(ids)\nnames = ','.join(names)\ndescriptions = ','.join(descriptions)\njsons = ','.join(jsons)\n","top":100,"left":210,"collector":null}},{"id":"FLINE_MW4","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_5","source_item":"FITEM_1","idcounter":4,"linebox_left":270,"linebox_top":100,"linebox_long":0,"linebox_top_width":20,"linebox_bottom_width":-20,"linebox_arrow_top":110,"linebox_arrow_left":266}},{"id":"FITEM_6","type":"dyasync","text":"動態並行","left":0,"top":0,"config":{"route":"$(ids)","route_type":"array","output":[{"value":"$(ids)","name":"$(UUID)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(names)","name":"$(Name)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(descriptions)","name":"$(Description)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(jsons)","name":"$(JSON)","des":"選擇要輸入並分解的陣列格式變數"}],"log":true,"top":175,"left":210}},{"id":"FLINE_MW8","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_6","source_item":"FITEM_5","idcounter":8,"linebox_left":270,"linebox_top":187.5,"linebox_long":0,"linebox_top_width":7.5,"linebox_bottom_width":-7.5,"linebox_arrow_top":185,"linebox_arrow_left":266}},{"id":"FITEM_7","type":"inflow","text":"流程","left":0,"top":0,"config":{"error_pass":false,"log":true,"flow_name":"建立ISE Identity Group表","subflow_input":[{"require":false,"value":"$(result)","name":"$(result)","des":""},{"require":false,"value":"$(UUID)","name":"$(UUID)","des":""},{"require":false,"value":"$(Name)","name":"$(Name)","des":""},{"require":false,"value":"$(Description)","name":"$(Description)","des":""},{"require":false,"value":"$(JSON)","name":"$(JSON)","des":""}],"subflow_output":[{"value":"$(result)","name":"$(result)","des":""}],"top":250,"left":210}},{"id":"FITEM_8","type":"dycollection","text":"動態匯集","left":0,"top":0,"config":{"output":[],"log":true,"json":false,"isreplace":false,"replace_string":"","top":325,"left":210}},{"id":"FLINE_MW9","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_7","source_item":"FITEM_6","idcounter":9,"linebox_left":270,"linebox_top":262.5,"linebox_long":0,"linebox_top_width":7.5,"linebox_bottom_width":-7.5,"linebox_arrow_top":260,"linebox_arrow_left":266}},{"id":"FLINE_MW10","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_8","source_item":"FITEM_7","idcounter":10,"linebox_left":270,"linebox_top":337.5,"linebox_long":0,"linebox_top_width":7.5,"linebox_bottom_width":-7.5,"linebox_arrow_top":335,"linebox_arrow_left":266}},{"id":"FLINE_MW11","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_8","idcounter":11,"linebox_left":270,"linebox_top":412.5,"linebox_long":0,"linebox_top_width":7.5,"linebox_bottom_width":-7.5,"linebox_arrow_top":410,"linebox_arrow_left":266}}],"version":16777216,"wnd_height":500,"uid":1671604442649},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":false,"name":"掃描ISE Identity Group","description":"","api_path":"e632a5e9-7384-4b36-faef-bf1807f64f8c","fp_show":true,"attachment":false,"relation":false,"worklog":false,"history":true,"mission":true,"flowlog":true,"api":true,"check_ticket":false,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"","custom_data_no_twy":"","custom_data_no_reset":"day"}},"flow_app_id__app_name":"OMFLOW CISCO ISE APP"},{"flow_name":"建立ISE Identity Group表","description":"","flowobject":{"flow_item_counter":5,"flow_line_counter":5,"form_object":{"form_item_counter":0,"form_box_counter":0,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[],"is_cform":false},"is_sub":false,"subflow":[],"items":[{"id":"FITEM_1","type":"start","text":"開始","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"callable":false,"input":[{"require":false,"value":"success","name":"result","des":""},{"require":false,"value":null,"name":"UUID","des":""},{"require":false,"value":null,"name":"Name","des":""},{"require":false,"value":null,"name":"Description","des":""},{"require":false,"value":null,"name":"JSON","des":""}],"output":[],"subflow_input":[],"subflow_output":[],"top":0,"left":210,"verify":false,"python_input":[{"require":false,"value":"success","name":"status","des":""},{"require":false,"value":null,"name":"message","des":""}],"python_output":[{"require":false,"value":"$(status)","name":"status","des":"輸出success則通過，其他則失敗"},{"require":false,"value":"$(message)","name":"message","des":""}],"python_code":"","packages":[]}},{"id":"FITEM_4","type":"end","text":"結束","left":0,"top":0,"config":{"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"top":275,"left":210}},{"id":"FITEM_5","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":"$(UUID)","name":"UUID","des":""},{"require":false,"value":"$(Name)","name":"Name","des":""},{"require":false,"value":"$(Description)","name":"Description","des":""},{"require":false,"value":"$(JSON)","name":"JSON","des":""},{"require":false,"value":null,"name":"result","des":""}],"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"packages":[],"code":"from omflow.syscom.tools import OmData\n\n\n# 宣告一個流程的物件\napi_path = 'a8d41d27-8c96-ce85-e647-524d1af03f2e'  # ISE Identity Groups表\ninc_flow_obj = OmData(api_path)\n# 填入表單資料(非必要，視流程需求)\ninc_flow_obj.setFormData('formitm_1', UUID)  # UUID\ninc_flow_obj.setFormData('formitm_2', Name)  # Name\ninc_flow_obj.setFormData('formitm_3', Description)  # Description\ninc_flow_obj.setFormData('formitm_4', JSON)  # JSON\n\n# 送出開單\nuser_id = '1'  # 使用者編號\nfiles = None  # 檔案\nresult =  inc_flow_obj.create(user_id, files)","top":125,"left":210,"collector":null}},{"id":"FLINE_MW4","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_5","source_item":"FITEM_1","idcounter":4,"linebox_left":270,"linebox_top":112.5,"linebox_long":0,"linebox_top_width":32.5,"linebox_bottom_width":-32.5,"linebox_arrow_top":135,"linebox_arrow_left":266}},{"id":"FLINE_MW5","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_5","idcounter":5,"linebox_left":270,"linebox_top":250,"linebox_long":0,"linebox_top_width":45,"linebox_bottom_width":-45,"linebox_arrow_top":285,"linebox_arrow_left":266}}],"version":16777216,"wnd_height":500,"uid":1671074797055},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":false,"name":"建立ISE Identity Group表","description":"","api_path":"40684511-dc50-9f19-ec70-0c4bceffa4cc","fp_show":true,"attachment":false,"relation":false,"worklog":false,"history":true,"mission":false,"flowlog":true,"api":true,"check_ticket":false,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"8","custom_data_no_twy":"0","custom_data_no_reset":"no"}},"flow_app_id__app_name":"OMFLOW CISCO ISE APP"},{"flow_name":"ISE Network Device表","description":"","flowobject":{"form_object":{"form_item_counter":6,"form_box_counter":2,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[{"id":"FORMBOX_1","type":"box12","parent":"public","hidden":false,"config":{"idcounter":1,"color":"box box-primary","title":"ISE Network Device表"}},{"id":"FORMITM_1","type":"inputbox","parent":"FORMBOX_1","hidden":false,"config":{"idcounter":1,"title":"name","require":true,"placeholder":"Resource name","type":"text","value":"","regex":"","readonly":false,"mask":false,"mask_head":"0","mask_tail":"0","mask_min":"3","scan":false,"rows":0}},{"id":"FORMITM_2","type":"inputbox","parent":"FORMBOX_1","hidden":false,"config":{"idcounter":2,"title":"id","require":true,"placeholder":"Resource UUID, mandatory for update","type":"text","value":"","regex":"","readonly":false,"mask":false,"mask_head":"0","mask_tail":"0","mask_min":"3","scan":false,"rows":0}},{"id":"FORMITM_4","type":"areabox","parent":"FORMBOX_1","hidden":false,"config":{"idcounter":4,"title":"description","require":false,"rows":"3","value":"","regex":"","readonly":false}},{"id":"FORMITM_5","type":"areabox","parent":"FORMBOX_1","hidden":false,"config":{"idcounter":5,"title":"詳細資訊","require":false,"rows":"9","value":"","regex":"","readonly":false}},{"id":"FORMBOX_2","type":"box6","parent":"public","hidden":false,"config":{"idcounter":2,"color":"box box-primary","title":"未命名"}},{"id":"FORMITM_6","type":"inputbox","parent":"FORMBOX_2","hidden":false,"config":{"idcounter":6,"title":"對應之Identity Group","require":false,"placeholder":"","type":"text","value":"","regex":"","readonly":false,"mask":false,"mask_head":"0","mask_tail":"0","mask_min":"3","scan":false,"rows":0}}],"is_cform":false}},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":true,"name":"ISE Network Device表","description":"","api_path":"b630c818-10c1-7d0b-07c0-3edfb5d1bf5c","attachment":false,"relation":false,"worklog":false,"history":true,"api":true,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"","custom_data_no_twy":"","custom_data_no_reset":"day"}},"flow_app_id__app_name":"OMFLOW CISCO ISE APP"},{"flow_name":"掃描ISE Network Device","description":"","flowobject":{"flow_item_counter":13,"flow_line_counter":22,"form_object":{"form_item_counter":0,"form_box_counter":0,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[],"is_cform":false},"is_sub":false,"subflow":[],"items":[{"id":"FITEM_1","type":"start","text":"開始","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"callable":false,"input":[{"require":false,"value":"success","name":"result","des":""}],"output":[],"subflow_input":[],"subflow_output":[],"top":0,"left":360,"verify":false,"python_input":[{"des":"","name":"status","value":"success"},{"des":"","name":"message","value":""}],"python_output":[{"des":"輸出success則通過，其他則失敗","name":"status","value":"$(status)"},{"des":"","name":"message","value":"$(message)"}],"python_code":"","packages":[]}},{"id":"FITEM_4","type":"end","text":"結束","left":0,"top":0,"config":{"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"top":800,"left":360}},{"id":"FITEM_5","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":null,"name":"ids","des":""},{"require":false,"value":null,"name":"names","des":""},{"require":false,"value":null,"name":"descriptions","des":""},{"require":false,"value":null,"name":"jsons","des":""}],"output":[{"value":"$(ids)","name":"$(ids)","des":""},{"value":"$(names)","name":"$(names)","des":""},{"value":"$(descriptions)","name":"$(descriptions)","des":""},{"value":"$(jsons)","name":"$(jsons)","des":""}],"calculate":[],"packages":[],"code":"#!/usr/bin/env python\n\nimport http.client\nimport base64\nimport ssl\nimport sys\n\n# host and authentication credentials\nhost = \"192.168.1.52\"  # \"10.20.30.40\"\nuser = \"apiadmin\"  # \"ersad\"\npassword = \"3edc$RFV\"  # \"Password1\"\n\n\nconn = http.client.HTTPSConnection(\"{}:9060\".format(host), context=ssl.SSLContext(ssl.PROTOCOL_TLSv1_2))\ncreds = str.encode(':'.join((user, password)))\nencodedAuth = bytes.decode(base64.b64encode(creds))\n\n\nheaders = {\n    'accept': \"application/json\",\n    'content-type': \"application/json\",\n    'authorization': \" \".join((\"Basic\", encodedAuth)),\n    'cache-control': \"no-cache\",\n    }\n\nconn.request(\"GET\", \"/ers/config/networkdevice\", headers=headers)\n\nres = conn.getresponse()\ndata = res.read()\nconn.close()\n\nprint(\"Status: {}\".format(res.status))\n# print(\"Header:\\n{}\".format(res.headers))\nprint(\"Body:\\n{}\".format(data.decode(\"utf-8\")))\n\nids = []\nnames = []\ndescriptions = []\njsons = []\nobjects = eval(data.decode(\"utf-8\"))\n\nfor obj in objects[\"SearchResult\"][\"resources\"]:\n    ids.append(obj['id'])\n    names.append(obj['name'])\n    descriptions.append(obj['description'])\n    jsons.append(str(obj))\n\nids = ','.join(ids)\nnames = ','.join(names)\ndescriptions = ','.join(descriptions)\njsons = ','.join(jsons)\n","top":100,"left":360,"collector":null,"autoinstall":false}},{"id":"FLINE_MW4","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_5","source_item":"FITEM_1","idcounter":4,"linebox_left":420,"linebox_top":100,"linebox_long":0,"linebox_top_width":20,"linebox_bottom_width":-20,"linebox_arrow_top":110,"linebox_arrow_left":416}},{"id":"FITEM_6","type":"dyasync","text":"動態並行","left":0,"top":0,"config":{"route":"$(ids)","route_type":"array","output":[{"value":"$(ids)","name":"$(UUID)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(names)","name":"$(Name)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(descriptions)","name":"$(Description)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(jsons)","name":"$(JSON)","des":"選擇要輸入並分解的陣列格式變數"}],"log":true,"top":175,"left":360}},{"id":"FLINE_MW8","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_6","source_item":"FITEM_5","idcounter":8,"linebox_left":420,"linebox_top":187.5,"linebox_long":0,"linebox_top_width":7.5,"linebox_bottom_width":-7.5,"linebox_arrow_top":185,"linebox_arrow_left":416}},{"id":"FITEM_7","type":"inflow","text":"建立ISE Network Device表","left":0,"top":0,"config":{"error_pass":false,"log":true,"flow_name":"建立ISE Network Device表","subflow_input":[{"require":false,"value":"$(result)","name":"$(result)","des":""},{"require":false,"value":"$(UUID)","name":"$(UUID)","des":""},{"require":false,"value":"$(Name)","name":"$(Name)","des":""},{"require":false,"value":"$(Description)","name":"$(Description)","des":""},{"require":false,"value":"$(JSON)","name":"$(JSON)","des":""}],"subflow_output":[{"value":"$(result)","name":"$(result)","des":""}],"top":550,"left":510}},{"id":"FITEM_8","type":"dycollection","text":"動態匯集","left":0,"top":0,"config":{"output":[],"log":true,"json":false,"isreplace":false,"replace_string":"","top":700,"left":360}},{"id":"FLINE_MW10","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_8","source_item":"FITEM_7","idcounter":10,"linebox_left":420,"linebox_top":675,"linebox_long":150,"linebox_top_width":45,"linebox_bottom_width":-45,"linebox_arrow_top":710,"linebox_arrow_left":416}},{"id":"FLINE_MW11","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_8","idcounter":11,"linebox_left":420,"linebox_top":800,"linebox_long":0,"linebox_top_width":20,"linebox_bottom_width":-20,"linebox_arrow_top":810,"linebox_arrow_left":416}},{"id":"FITEM_9","type":"python","text":"查詢ISE Network Device表","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":"$(UUID)","name":"UUID","des":""},{"require":false,"value":"$(No)","name":"No","des":""},{"require":false,"value":"$(Name)","name":"Name","des":""},{"require":false,"value":"$(Source)","name":"Source","des":""},{"require":false,"value":"$(Destination)","name":"Destination","des":""},{"require":false,"value":"$(Port)","name":"Port","des":""},{"require":false,"value":"$(VPN)","name":"VPN","des":""},{"require":false,"value":"$(ServiceApplications)","name":"ServiceApplications","des":""},{"require":false,"value":"$(Action)","name":"Action","des":""},{"require":false,"value":"$(Status)","name":"Status","des":""},{"require":false,"value":"$(InstallOn)","name":"InstallOn","des":""},{"require":false,"value":null,"name":"result","des":""},{"require":false,"value":null,"name":"objectJson","des":""},{"require":false,"value":null,"name":"data_no","des":""}],"output":[{"value":"$(result)","name":"$(result)","des":""},{"value":"$(objectJson)","name":"$(objectJson)","des":""},{"value":"$(data_no)","name":"$(data_no)","des":""}],"calculate":[],"packages":[],"code":"from omflow.syscom.tools import OmData\n\n\n#宣告一個流程的物件\napi_path = 'b630c818-10c1-7d0b-07c0-3edfb5d1bf5c'  # ISE Network Device表\ninc_flow_obj = OmData(api_path)\n\n#列表\nsearch_conditions = [\n    {'column': 'history', 'condition': '=', 'value': False},  #查詢條件，查詢非歷史資料\n    {'column': 'formitm_2', 'condition': '=', 'value': UUID},  # 查詢條件，UUID\n]\nsearch_columns = ['data_no', 'formitm_2', 'formitm_5']  #取得欄位，取得單號以及欄位1\nexclude_conditions = []  # 排除條件，排除已關單資料\norder_columns = ['-data_no']     #使用單號逆排序\nlimit = 0                        #取得所有資料(若值給100代表取得前100筆資料)\nstart = 0                        #從第1筆資料開始\nresult = inc_flow_obj.list(search_conditions, search_columns, exclude_conditions, order_columns, limit, start)\nif result['status']:\n    data_no = []\n    objectJson = []\n    objectId = []\n    for ele in result['result']:\n        data_no.append(str(ele['data_no']))\n        objectId.append(ele['formitm_2'])\n        objectJson.append(ele['formitm_5'])\n    result = ','.join(data_no)\n    data_no = ','.join(data_no)\n    objectId = ','.join(objectId)\n    objectJson = ','.join(objectJson)\nelse:\n    result = None\n","top":250,"left":360,"collector":null,"autoinstall":false}},{"id":"FLINE_MW12","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_9","source_item":"FITEM_6","idcounter":12,"linebox_left":420,"linebox_top":262.5,"linebox_long":0,"linebox_top_width":7.5,"linebox_bottom_width":-7.5,"linebox_arrow_top":260,"linebox_arrow_left":416}},{"id":"FITEM_10","type":"switch","text":"判斷data no","left":0,"top":0,"config":{"calculate":[],"rules":[{"target":"FITEM_7","value1":"$(data_no)","value2":null,"rule":"="},{"target":"FITEM_11","value1":"$(data_no)","value2":null,"rule":"!="}],"log":true,"top":450,"left":360}},{"id":"FLINE_MW14","type":"line","config":{"target_side":"top","source_side":"right","target_item":"FITEM_7","source_item":"FITEM_10","idcounter":14,"linebox_left":570,"linebox_top":500,"linebox_long":0,"linebox_top_width":-90,"linebox_bottom_width":70,"linebox_arrow_top":560,"linebox_arrow_left":566}},{"id":"FITEM_11","type":"switch","text":"判斷json","left":0,"top":0,"config":{"calculate":[],"rules":[{"target":"FITEM_12","value1":"$(JSON)","value2":"$(objectJson)","rule":"!="},{"target":"FITEM_8","value1":"$(JSON)","value2":"$(objectJson)","rule":"="}],"log":true,"top":550,"left":210}},{"id":"FLINE_MW15","type":"line","config":{"target_side":"top","source_side":"left","target_item":"FITEM_11","source_item":"FITEM_10","idcounter":15,"linebox_left":270,"linebox_top":500,"linebox_long":0,"linebox_top_width":90,"linebox_bottom_width":70,"linebox_arrow_top":560,"linebox_arrow_left":266}},{"id":"FITEM_12","type":"python","text":"進階推單ISE Network Device表","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":"$(UUID)","name":"UUID","des":""},{"require":false,"value":"$(Name)","name":"Name","des":""},{"require":false,"value":"$(Description)","name":"Description","des":""},{"require":false,"value":"$(JSON)","name":"JSON","des":""},{"require":false,"value":null,"name":"result","des":""},{"require":false,"value":null,"name":"message","des":""}],"output":[{"value":"$(result)","name":"$(result)","des":""},{"value":"$(message)","name":"$(message)","des":""}],"calculate":[],"packages":[],"code":"from omflow.syscom.tools import OmData\n\n\n# 宣告一個流程的物件\napi_path = 'b630c818-10c1-7d0b-07c0-3edfb5d1bf5c'  # ISE Network Device表\ninc_flow_obj = OmData(api_path)\n# 填入表單資料(非必要，視流程需求)\ninc_flow_obj.setFormData('formitm_1', Name)  # Name\ninc_flow_obj.setFormData('formitm_2', UUID)  # UUID\ninc_flow_obj.setFormData('formitm_4', Description)  # Description\ninc_flow_obj.setFormData('formitm_5', JSON)  # JSON\n\n#推單\ncondition = [\n    {'column': 'history', 'condition': '=', 'value': False},\n    {'column': 'formitm_2', 'condition': '=', 'value': UUID}\n]  #查詢條件\n   \n\nuser_id = '1'                  #使用者編號\nfiles = None                   #檔案\nupdate_duplicate = False       #當條件查詢回來的資料為複數筆時，是否將其全部推進。若否，則全部不推進並回傳失敗訊息。\nupdate_duplicate_interval = 0  #當推進的資料為複數筆時，每一筆推進的間隔時間(秒)\nwait_time_max = 0              #當查詢回來的資料筆數為0時，要進行n次重新查詢，n次查詢都為0後回傳錯誤訊息。\nwait_time_seconds = 0          #每次重新查詢的間隔時間(秒)\nresult = inc_flow_obj.advanced_update(condition, user_id, files, update_duplicate, update_duplicate_interval, wait_time_seconds, wait_time_max)\n\n#取得回傳\nstatus = result['status']      #狀態True/False\nmessage = result['message']    #回傳訊息。成功推單的data_id或是失敗訊息。","top":625,"left":60,"collector":null,"autoinstall":false}},{"id":"FLINE_MH18","type":"line","config":{"target_side":"left","source_side":"bottom","target_item":"FITEM_8","source_item":"FITEM_12","idcounter":18,"linebox_left":120,"linebox_top":750,"linebox_long":0,"linebox_top_width":240,"linebox_bottom_width":-45,"linebox_arrow_top":746,"linebox_arrow_left":350}},{"id":"FLINE_MW19","type":"line","config":{"target_side":"top","source_side":"right","target_item":"FITEM_8","source_item":"FITEM_11","idcounter":19,"linebox_left":420,"linebox_top":600,"linebox_long":0,"linebox_top_width":-90,"linebox_bottom_width":120,"linebox_arrow_top":710,"linebox_arrow_left":416}},{"id":"FLINE_MW20","type":"line","config":{"target_side":"top","source_side":"left","target_item":"FITEM_12","source_item":"FITEM_11","idcounter":20,"linebox_left":120,"linebox_top":600,"linebox_long":0,"linebox_top_width":90,"linebox_bottom_width":45,"linebox_arrow_top":635,"linebox_arrow_left":116}},{"id":"FITEM_13","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":true,"value":"$(UUID)","name":"UUID","des":""},{"require":false,"value":null,"name":"JSON","des":""}],"output":[{"value":"$(JSON)","name":"$(JSON)","des":""}],"calculate":[],"packages":[],"code":"#!/usr/bin/env python\n\nimport http.client\nimport base64\nimport ssl\nimport sys\nimport json\n\n# host and authentication credentials\nhost = \"192.168.1.52\"  # \"10.20.30.40\"\nuser = \"apiadmin\"  # \"ersad\"\npassword = \"3edc$RFV\"  # \"Password1\"\n\n\nconn = http.client.HTTPSConnection(\"{}:9060\".format(host), context=ssl.SSLContext(ssl.PROTOCOL_TLSv1_2))\ncreds = str.encode(':'.join((user, password)))\nencodedAuth = bytes.decode(base64.b64encode(creds))\n\n\nheaders = {\n    'accept': \"application/json\",\n    'content-type': \"application/json\",\n    'authorization': \" \".join((\"Basic\", encodedAuth)),\n    'cache-control': \"no-cache\",\n    }\n\nconn.request(\"GET\", f\"/ers/config/networkdevice/{UUID}\", headers=headers)\n\nres = conn.getresponse()\ndata = res.read()\nconn.close()\n\nprint(\"Status: {}\".format(res.status))\n# print(\"Header:\\n{}\".format(res.headers))\nprint(\"Body:\\n{}\".format(data.decode(\"utf-8\")))\n\nJSON = json.loads(data.decode(\"utf-8\"))[\"NetworkDevice\"]\nJSON = json.dumps(data.decode(\"utf-8\"), indent=4)\n","top":350,"left":360,"collector":null}},{"id":"FLINE_MW21","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_13","source_item":"FITEM_9","idcounter":21,"linebox_left":420,"linebox_top":350,"linebox_long":0,"linebox_top_width":20,"linebox_bottom_width":-20,"linebox_arrow_top":360,"linebox_arrow_left":416}},{"id":"FLINE_MW22","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_10","source_item":"FITEM_13","idcounter":22,"linebox_left":420,"linebox_top":450,"linebox_long":0,"linebox_top_width":20,"linebox_bottom_width":-20,"linebox_arrow_top":460,"linebox_arrow_left":416}}],"version":16777216,"wnd_height":912,"uid":1671604442649},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":false,"name":"掃描ISE Network Device","description":"","api_path":"05960574-73ae-e2ea-4e14-49b99cd0c35c","fp_show":true,"attachment":false,"relation":false,"worklog":false,"history":true,"mission":true,"flowlog":true,"api":true,"check_ticket":false,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"","custom_data_no_twy":"","custom_data_no_reset":"day"}},"flow_app_id__app_name":"OMFLOW CISCO ISE APP"},{"flow_name":"建立ISE Network Device表","description":"","flowobject":{"flow_item_counter":5,"flow_line_counter":5,"form_object":{"form_item_counter":0,"form_box_counter":0,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[],"is_cform":false},"is_sub":false,"subflow":[],"items":[{"id":"FITEM_1","type":"start","text":"開始","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"callable":false,"input":[{"require":false,"value":"success","name":"result","des":""},{"require":false,"value":null,"name":"UUID","des":""},{"require":false,"value":null,"name":"Name","des":""},{"require":false,"value":null,"name":"Description","des":""},{"require":false,"value":null,"name":"JSON","des":""}],"output":[],"subflow_input":[],"subflow_output":[],"top":0,"left":210,"verify":false,"python_input":[{"require":false,"value":"success","name":"status","des":""},{"require":false,"value":null,"name":"message","des":""}],"python_output":[{"require":false,"value":"$(status)","name":"status","des":"輸出success則通過，其他則失敗"},{"require":false,"value":"$(message)","name":"message","des":""}],"python_code":"","packages":[]}},{"id":"FITEM_4","type":"end","text":"結束","left":0,"top":0,"config":{"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"top":275,"left":210}},{"id":"FITEM_5","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":"$(UUID)","name":"UUID","des":""},{"require":false,"value":"$(Name)","name":"Name","des":""},{"require":false,"value":"$(Description)","name":"Description","des":""},{"require":false,"value":"$(JSON)","name":"JSON","des":""},{"require":false,"value":null,"name":"result","des":""}],"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"packages":[],"code":"from omflow.syscom.tools import OmData\n\n\n# 宣告一個流程的物件\napi_path = 'b630c818-10c1-7d0b-07c0-3edfb5d1bf5c'  # ISE Network Device表\ninc_flow_obj = OmData(api_path)\n# 填入表單資料(非必要，視流程需求)\ninc_flow_obj.setFormData('formitm_1', Name)  # Name\ninc_flow_obj.setFormData('formitm_2', UUID)  # UUID\ninc_flow_obj.setFormData('formitm_4', Description)  # Description\ninc_flow_obj.setFormData('formitm_5', JSON)  # JSON\n\n# 送出開單\nuser_id = '1'  # 使用者編號\nfiles = None  # 檔案\nresult =  inc_flow_obj.create(user_id, files)","top":125,"left":210,"collector":null}},{"id":"FLINE_MW4","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_5","source_item":"FITEM_1","idcounter":4,"linebox_left":270,"linebox_top":112.5,"linebox_long":0,"linebox_top_width":32.5,"linebox_bottom_width":-32.5,"linebox_arrow_top":135,"linebox_arrow_left":266}},{"id":"FLINE_MW5","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_5","idcounter":5,"linebox_left":270,"linebox_top":250,"linebox_long":0,"linebox_top_width":45,"linebox_bottom_width":-45,"linebox_arrow_top":285,"linebox_arrow_left":266}}],"version":16777216,"wnd_height":500,"uid":1671074797055},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":false,"name":"建立ISE Network Device表","description":"","api_path":"fed3b7e0-002d-543c-9b1f-793753d00949","fp_show":true,"attachment":false,"relation":false,"worklog":false,"history":true,"mission":false,"flowlog":true,"api":true,"check_ticket":false,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"8","custom_data_no_twy":"0","custom_data_no_reset":"no"}},"flow_app_id__app_name":"OMFLOW CISCO ISE APP"}]}]