[{"app_name":"OMFLOW CISCO FirePower APP","app_attr":"user","language_package":"{\"zh-hant\": {\"OMFLOW CISCO FirePower APP\": \"\"}, \"en\": {\"OMFLOW CISCO FirePower APP\": \"\"}, \"ja\": {\"OMFLOW CISCO FirePower APP\": \"\"}, \"zh-hans\": {\"OMFLOW CISCO FirePower APP\": \"\"}}","flow_list":[{"flow_name":"建立防火牆規則表[Access_Rule]","description":"","flowobject":{"flow_item_counter":5,"flow_line_counter":5,"form_object":{"form_item_counter":0,"form_box_counter":0,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[],"is_cform":false},"is_sub":false,"subflow":[],"items":[{"id":"FITEM_1","type":"start","text":"開始","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"callable":false,"input":[{"require":false,"value":"success","name":"result","des":""},{"require":false,"value":null,"name":"UUID","des":""},{"require":false,"value":null,"name":"No","des":""},{"require":false,"value":null,"name":"Name","des":""},{"require":false,"value":null,"name":"Source","des":""},{"require":false,"value":null,"name":"Destination","des":""},{"require":false,"value":null,"name":"Port","des":""},{"require":false,"value":null,"name":"VPN","des":""},{"require":false,"value":null,"name":"ServiceApplications","des":""},{"require":false,"value":null,"name":"Action","des":""},{"require":false,"value":null,"name":"Status","des":""},{"require":false,"value":null,"name":"InstallOn","des":""},{"require":false,"value":null,"name":"JSON","des":""}],"output":[],"subflow_input":[],"subflow_output":[],"top":0,"left":210,"verify":false,"python_input":[{"require":false,"value":"success","name":"status","des":""},{"require":false,"value":null,"name":"message","des":""}],"python_output":[{"require":false,"value":"$(status)","name":"status","des":"輸出success則通過，其他則失敗"},{"require":false,"value":"$(message)","name":"message","des":""}],"python_code":"","packages":[]}},{"id":"FITEM_4","type":"end","text":"結束","left":0,"top":0,"config":{"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"top":275,"left":210}},{"id":"FITEM_5","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":"$(UUID)","name":"UUID","des":""},{"require":false,"value":"$(No)","name":"No","des":""},{"require":false,"value":"$(Name)","name":"Name","des":""},{"require":false,"value":"$(Source)","name":"Source","des":""},{"require":false,"value":"$(Destination)","name":"Destination","des":""},{"require":false,"value":"$(Port)","name":"Port","des":""},{"require":false,"value":"$(VPN)","name":"VPN","des":""},{"require":false,"value":"$(ServiceApplications)","name":"ServiceApplications","des":""},{"require":false,"value":"$(Action)","name":"Action","des":""},{"require":false,"value":"$(Status)","name":"Status","des":""},{"require":false,"value":"$(InstallOn)","name":"InstallOn","des":""},{"require":false,"value":"$(JSON)","name":"JSON","des":""},{"require":false,"value":null,"name":"result","des":""}],"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"packages":[],"code":"from omflow.syscom.tools import OmData\n\n\n# 宣告一個流程的物件\napi_path = 'c011d29a-8738-6f97-4b25-3bbecb55d186'  # 防火牆規則表[Access_Rule]\ninc_flow_obj = OmData(api_path)\n# 填入表單資料(非必要，視流程需求)\ninc_flow_obj.setFormData('formitm_1', UUID)  # UUID\ninc_flow_obj.setFormData('formitm_2', No)  # No\ninc_flow_obj.setFormData('formitm_3', Name)  # Name\ninc_flow_obj.setFormData('formitm_4', Source)  # Source\ninc_flow_obj.setFormData('formitm_5', Destination)  # Destination\ninc_flow_obj.setFormData('formitm_6', Port)  # Port\ninc_flow_obj.setFormData('formitm_7', VPN)  # VPN\ninc_flow_obj.setFormData('formitm_8', ServiceApplications)  # Service & Applications\ninc_flow_obj.setFormData('formitm_9', Action)  # Action\ninc_flow_obj.setFormData('formitm_10', Status)  # Status\ninc_flow_obj.setFormData('formitm_11', InstallOn)  # Install On\ninc_flow_obj.setFormData('formitm_12', JSON)  # Install On\n# 送出開單\nuser_id = '1'  # 使用者編號\nfiles = None  # 檔案\nresult =  inc_flow_obj.create(user_id, files)","top":125,"left":210,"collector":null}},{"id":"FLINE_MW4","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_5","source_item":"FITEM_1","idcounter":4,"linebox_left":270,"linebox_top":112.5,"linebox_long":0,"linebox_top_width":32.5,"linebox_bottom_width":-32.5,"linebox_arrow_top":135,"linebox_arrow_left":266}},{"id":"FLINE_MW5","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_5","idcounter":5,"linebox_left":270,"linebox_top":250,"linebox_long":0,"linebox_top_width":45,"linebox_bottom_width":-45,"linebox_arrow_top":285,"linebox_arrow_left":266}}],"version":16777216,"wnd_height":500,"uid":1671074797055},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":false,"name":"建立防火牆規則表[Access_Rule]","description":"","api_path":"3f5ee639-67cf-a4cf-804c-d0f8769d5b39","fp_show":true,"attachment":false,"relation":false,"worklog":false,"history":true,"mission":false,"flowlog":true,"api":true,"check_ticket":false,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"8","custom_data_no_twy":"0","custom_data_no_reset":"no"}},"flow_app_id__app_name":"OMFLOW CISCO FirePower APP"},{"flow_name":"查詢防火牆規則表[Access_Rule]","description":"","flowobject":{"flow_item_counter":5,"flow_line_counter":5,"form_object":{"form_item_counter":0,"form_box_counter":0,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[],"is_cform":false},"is_sub":false,"subflow":[],"items":[{"id":"FITEM_1","type":"start","text":"開始","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"callable":false,"input":[{"require":false,"value":"success","name":"result","des":""},{"require":false,"value":null,"name":"UUID","des":""},{"require":false,"value":null,"name":"No","des":""},{"require":false,"value":null,"name":"Name","des":""},{"require":false,"value":null,"name":"Source","des":""},{"require":false,"value":null,"name":"Destination","des":""},{"require":false,"value":null,"name":"Port","des":""},{"require":false,"value":null,"name":"VPN","des":""},{"require":false,"value":null,"name":"ServiceApplications","des":""},{"require":false,"value":null,"name":"Action","des":""},{"require":false,"value":null,"name":"Status","des":""},{"require":false,"value":null,"name":"InstallOn","des":""},{"require":false,"value":null,"name":"JSON","des":""}],"output":[],"subflow_input":[],"subflow_output":[],"top":0,"left":210,"verify":false,"python_input":[{"require":false,"value":"success","name":"status","des":""},{"require":false,"value":null,"name":"message","des":""}],"python_output":[{"require":false,"value":"$(status)","name":"status","des":"輸出success則通過，其他則失敗"},{"require":false,"value":"$(message)","name":"message","des":""}],"python_code":"","packages":[]}},{"id":"FITEM_4","type":"end","text":"結束","left":0,"top":0,"config":{"output":[{"value":"$(result)","name":"$(result)","des":""},{"value":"$(data_no)","name":"$(data_no)","des":""},{"value":"$(objectJson)","name":"$(objectJson)","des":""}],"calculate":[],"top":275,"left":210}},{"id":"FITEM_5","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":"$(UUID)","name":"UUID","des":""},{"require":false,"value":"$(No)","name":"No","des":""},{"require":false,"value":"$(Name)","name":"Name","des":""},{"require":false,"value":"$(Source)","name":"Source","des":""},{"require":false,"value":"$(Destination)","name":"Destination","des":""},{"require":false,"value":"$(Port)","name":"Port","des":""},{"require":false,"value":"$(VPN)","name":"VPN","des":""},{"require":false,"value":"$(ServiceApplications)","name":"ServiceApplications","des":""},{"require":false,"value":"$(Action)","name":"Action","des":""},{"require":false,"value":"$(Status)","name":"Status","des":""},{"require":false,"value":"$(InstallOn)","name":"InstallOn","des":""},{"require":false,"value":null,"name":"result","des":""},{"require":false,"value":null,"name":"objectJson","des":""},{"require":false,"value":null,"name":"data_no","des":""}],"output":[{"value":"$(result)","name":"$(result)","des":""},{"value":"$(objectJson)","name":"$(objectJson)","des":""},{"value":"$(data_no)","name":"$(data_no)","des":""}],"calculate":[],"packages":[],"code":"from omflow.syscom.tools import OmData\n\n\n#宣告一個流程的物件\napi_path = 'c011d29a-8738-6f97-4b25-3bbecb55d186'\ninc_flow_obj = OmData(api_path)\n\n#列表\nsearch_conditions = [\n    {'column': 'history', 'condition': '=', 'value': False},  #查詢條件，查詢非歷史資料\n    {'column': 'formitm_1', 'condition': '=', 'value': UUID},  # 查詢條件，UUID\n]\nsearch_columns = ['data_no', 'formitm_1', 'formitm_12']  #取得欄位，取得單號以及欄位1\nexclude_conditions = []  # 排除條件，排除已關單資料\norder_columns = ['-data_no']     #使用單號逆排序\nlimit = 0                        #取得所有資料(若值給100代表取得前100筆資料)\nstart = 0                        #從第1筆資料開始\nresult = inc_flow_obj.list(search_conditions, search_columns, exclude_conditions, order_columns, limit, start)\nif result['status']:\n    data_no = []\n    objectJson = []\n    objectId = []\n    for ele in result['result']:\n        data_no.append(str(ele['data_no']))\n        objectId.append(ele['formitm_1'])\n        objectJson.append(ele['formitm_12'])\n    result = ','.join(data_no)\n    data_no = ','.join(data_no)\n    objectId = ','.join(objectId)\n    objectJson = ','.join(objectJson)\nelse:\n    result = None\n","top":125,"left":210,"collector":null}},{"id":"FLINE_MW4","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_5","source_item":"FITEM_1","idcounter":4,"linebox_left":270,"linebox_top":112.5,"linebox_long":0,"linebox_top_width":32.5,"linebox_bottom_width":-32.5,"linebox_arrow_top":135,"linebox_arrow_left":266}},{"id":"FLINE_MW5","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_5","idcounter":5,"linebox_left":270,"linebox_top":250,"linebox_long":0,"linebox_top_width":45,"linebox_bottom_width":-45,"linebox_arrow_top":285,"linebox_arrow_left":266}}],"version":16777216,"wnd_height":500,"uid":1671074797055},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":false,"name":"查詢防火牆規則表[Access_Rule]","description":"","api_path":"d25f8232-70b2-dca8-1919-38eff4548798","fp_show":true,"attachment":false,"relation":false,"worklog":false,"history":true,"mission":false,"flowlog":true,"api":true,"check_ticket":false,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"8","custom_data_no_twy":"0","custom_data_no_reset":"no"}},"flow_app_id__app_name":"OMFLOW CISCO FirePower APP"},{"flow_name":"進階推單防火牆規則表[Access_Rule]","description":"by UUID","flowobject":{"flow_item_counter":6,"flow_line_counter":8,"form_object":{"form_item_counter":0,"form_box_counter":0,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[],"is_cform":false},"is_sub":false,"subflow":[],"items":[{"id":"FITEM_1","type":"start","text":"開始","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"callable":false,"input":[{"require":false,"value":"success","name":"result","des":""},{"require":false,"value":null,"name":"UUID","des":""},{"require":false,"value":null,"name":"No","des":""},{"require":false,"value":null,"name":"Name","des":""},{"require":false,"value":null,"name":"Source","des":""},{"require":false,"value":null,"name":"Destination","des":""},{"require":false,"value":null,"name":"Port","des":""},{"require":false,"value":null,"name":"VPN","des":""},{"require":false,"value":null,"name":"ServiceApplications","des":""},{"require":false,"value":null,"name":"Action","des":""},{"require":false,"value":null,"name":"Status","des":""},{"require":false,"value":null,"name":"InstallOn","des":""},{"require":false,"value":null,"name":"JSON","des":""}],"output":[],"subflow_input":[],"subflow_output":[],"top":0,"left":210,"verify":false,"python_input":[{"require":false,"value":"success","name":"status","des":""},{"require":false,"value":null,"name":"message","des":""}],"python_output":[{"require":false,"value":"$(status)","name":"status","des":"輸出success則通過，其他則失敗"},{"require":false,"value":"$(message)","name":"message","des":""}],"python_code":"","packages":[]}},{"id":"FITEM_4","type":"end","text":"結束","left":0,"top":0,"config":{"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"top":275,"left":210}},{"id":"FITEM_5","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":"$(objectName)","name":"objectName","des":""},{"require":false,"value":"$(objectType)","name":"objectType","des":""},{"require":false,"value":"$(objectSelfLink)","name":"objectSelfLink","des":""},{"require":false,"value":"$(objectParentLink)","name":"objectParentLink","des":""},{"require":true,"value":"$(objectId)","name":"objectId","des":""},{"require":false,"value":"$(objectJson)","name":"objectJson","des":""},{"require":false,"value":null,"name":"status","des":""},{"require":false,"value":null,"name":"message","des":""}],"output":[{"value":"$(status)","name":"$(status)","des":""},{"value":"$(message)","name":"$(message)","des":""}],"calculate":[],"packages":[],"code":"from omflow.syscom.tools import OmData\n\n#宣告一個流程的物件\napi_path = '5e3c4a58-f390-5959-8e37-5ff16a64d573'\ninc_flow_obj = OmData(api_path)\n\n#填入表單資料(非必要，視流程需求)\ninc_flow_obj.setFormData('formitm_1', objectName)  # name\ninc_flow_obj.setFormData('formitm_2', objectType)  # type\ninc_flow_obj.setFormData('formitm_3', objectSelfLink)  # self link\ninc_flow_obj.setFormData('formitm_4', objectParentLink)  # parent link\ninc_flow_obj.setFormData('formitm_5', objectId)  # id\ninc_flow_obj.setFormData('formitm_6', objectJson)  # 詳細資料(JSON)\n\n#推單\ncondition = [\n    {'column': 'history', 'condition': '=', 'value': False},\n    {'column': 'formitm_5', 'condition': '=', 'value': objectId}\n]  #查詢條件\n\nuser_id = '1'                  #使用者編號\nfiles = None                   #檔案\nupdate_duplicate = False       #當條件查詢回來的資料為複數筆時，是否將其全部推進。若否，則全部不推進並回傳失敗訊息。\nupdate_duplicate_interval = 0  #當推進的資料為複數筆時，每一筆推進的間隔時間(秒)\nwait_time_max = 0              #當查詢回來的資料筆數為0時，要進行n次重新查詢，n次查詢都為0後回傳錯誤訊息。\nwait_time_seconds = 0          #每次重新查詢的間隔時間(秒)\nresult = inc_flow_obj.advanced_update(condition, user_id, files, update_duplicate, update_duplicate_interval, wait_time_seconds, wait_time_max)\n\n#取得回傳\nstatus = result['status']      #狀態True/False\nmessage = result['message']    #回傳訊息。成功推單的data_id或是失敗訊息。\n","top":150,"left":810,"collector":null,"autoinstall":false}},{"id":"FLINE_MH5","type":"line","config":{"target_side":"right","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_5","idcounter":5,"linebox_left":870,"linebox_top":325,"linebox_long":0,"linebox_top_width":-540,"linebox_bottom_width":-95,"linebox_arrow_top":321,"linebox_arrow_left":330}},{"id":"FITEM_6","type":"python","text":"執行","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":"$(UUID)","name":"UUID","des":""},{"require":false,"value":"$(No)","name":"No","des":""},{"require":false,"value":"$(Name)","name":"Name","des":""},{"require":false,"value":"$(Source)","name":"Source","des":""},{"require":false,"value":"$(Destination)","name":"Destination","des":""},{"require":false,"value":"$(Port)","name":"Port","des":""},{"require":false,"value":"$(VPN)","name":"VPN","des":""},{"require":false,"value":"$(ServiceApplications)","name":"ServiceApplications","des":""},{"require":false,"value":"$(Action)","name":"Action","des":""},{"require":false,"value":"$(Status)","name":"Status","des":""},{"require":false,"value":"$(InstallOn)","name":"InstallOn","des":""},{"require":false,"value":"$(JSON)","name":"JSON","des":""},{"require":false,"value":null,"name":"result","des":""}],"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"packages":[],"code":"from omflow.syscom.tools import OmData\n\n\n# 宣告一個流程的物件\napi_path = 'c011d29a-8738-6f97-4b25-3bbecb55d186'  # 防火牆規則表[Access_Rule]\ninc_flow_obj = OmData(api_path)\n# 填入表單資料(非必要，視流程需求)\ninc_flow_obj.setFormData('formitm_2', No)  # No\ninc_flow_obj.setFormData('formitm_3', Name)  # Name\ninc_flow_obj.setFormData('formitm_4', Source)  # Source\ninc_flow_obj.setFormData('formitm_5', Destination)  # Destination\ninc_flow_obj.setFormData('formitm_6', Port)  # Port\ninc_flow_obj.setFormData('formitm_7', VPN)  # VPN\ninc_flow_obj.setFormData('formitm_8', ServiceApplications)  # Service & Applications\ninc_flow_obj.setFormData('formitm_9', Action)  # Action\ninc_flow_obj.setFormData('formitm_10', Status)  # Status\ninc_flow_obj.setFormData('formitm_11', InstallOn)  # Install On\ninc_flow_obj.setFormData('formitm_12', JSON)  # Install On\n\n#推單\ncondition = [{'column': 'history', 'condition': '=', 'value': False}]  #查詢條件\nif UUID:\n    condition.append({'column': 'formitm_1', 'condition': '=', 'value': UUID})\nif Name:\n    condition.append({'column': 'formitm_3', 'condition': '=', 'value': Name})\n    \n\nuser_id = '1'                  #使用者編號\nfiles = None                   #檔案\nupdate_duplicate = False       #當條件查詢回來的資料為複數筆時，是否將其全部推進。若否，則全部不推進並回傳失敗訊息。\nupdate_duplicate_interval = 0  #當推進的資料為複數筆時，每一筆推進的間隔時間(秒)\nwait_time_max = 0              #當查詢回來的資料筆數為0時，要進行n次重新查詢，n次查詢都為0後回傳錯誤訊息。\nwait_time_seconds = 0          #每次重新查詢的間隔時間(秒)\nresult = inc_flow_obj.advanced_update(condition, user_id, files, update_duplicate, update_duplicate_interval, wait_time_seconds, wait_time_max)\n\n#取得回傳\nstatus = result['status']      #狀態True/False\nmessage = result['message']    #回傳訊息。成功推單的data_id或是失敗訊息。","top":125,"left":210,"collector":null}},{"id":"FLINE_MW6","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_6","source_item":"FITEM_1","idcounter":6,"linebox_left":270,"linebox_top":112.5,"linebox_long":0,"linebox_top_width":32.5,"linebox_bottom_width":-32.5,"linebox_arrow_top":135,"linebox_arrow_left":266}},{"id":"FLINE_MW8","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_6","idcounter":8,"linebox_left":270,"linebox_top":250,"linebox_long":0,"linebox_top_width":45,"linebox_bottom_width":-45,"linebox_arrow_top":285,"linebox_arrow_left":266}}],"version":16777216,"wnd_height":500,"uid":1671167129404},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":false,"name":"進階推單防火牆規則表[Access_Rule]","description":"by UUID","api_path":"34730966-ed64-fac3-ec76-a2d4560ea3a6","fp_show":true,"attachment":false,"relation":false,"worklog":false,"history":true,"mission":true,"flowlog":true,"api":true,"check_ticket":false,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"","custom_data_no_twy":"","custom_data_no_reset":"day"}},"flow_app_id__app_name":"OMFLOW CISCO FirePower APP"},{"flow_name":"掃描防火牆規則[Access_Rule]","description":"","flowobject":{"flow_item_counter":15,"flow_line_counter":25,"form_object":{"form_item_counter":0,"form_box_counter":0,"form_calculate_counter":0,"form_label_counter":0,"user":[],"group":[],"level":[],"title":false,"status":[],"op1":[],"op2":[],"items":[],"is_cform":false},"is_sub":false,"subflow":[],"items":[{"id":"FITEM_1","type":"start","text":"開始","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"callable":false,"input":[{"require":false,"value":"success","name":"result","des":""}],"output":[],"subflow_input":[],"subflow_output":[],"top":0,"left":570,"verify":false,"python_input":[{"des":"","name":"status","value":"success"},{"des":"","name":"message","value":""}],"python_output":[{"des":"輸出success則通過，其他則失敗","name":"status","value":"$(status)"},{"des":"","name":"message","value":"$(message)"}],"python_code":"","packages":[]}},{"id":"FITEM_2","type":"form","text":"人工輸入","left":0,"top":0,"config":{"calculate":[],"input":[],"output":[],"form_object":null,"form_setdata":[],"subflow_id":"","subflow_input":[],"subflow_output":[],"log":true,"top":775,"left":750,"input1":[],"input2":[],"cform_object":null,"action1":false,"action2":false,"action1_text":"","action2_text":"","verify":false,"python_input":[{"des":"","name":"status","value":"success"},{"des":"","name":"message","value":""}],"packages":[],"python_code":"","python_output":[{"des":"輸出success則通過，其他則失敗","name":"status","value":"$(status)"},{"des":"","name":"message","value":"$(message)"}]}},{"id":"FITEM_4","type":"end","text":"結束","left":0,"top":0,"config":{"output":[{"value":"$(result)","name":"$(result)","des":""}],"calculate":[],"top":875,"left":570}},{"id":"FITEM_5","type":"python","text":"執行-呼叫FMC","left":0,"top":0,"config":{"error_pass":false,"load_balance":false,"log":true,"input":[{"require":false,"value":null,"name":"UUIDList","des":""},{"require":false,"value":null,"name":"NoList","des":""},{"require":false,"value":null,"name":"NameList","des":""},{"require":false,"value":null,"name":"SourceList","des":""},{"require":false,"value":null,"name":"DestinationList","des":""},{"require":false,"value":null,"name":"PortList","des":""},{"require":false,"value":null,"name":"JSONList","des":""},{"require":false,"value":"192.168.1.50","name":"host","des":""},{"require":false,"value":"apiadmin","name":"username","des":""},{"require":false,"value":"1qaz@WSX","name":"password","des":""},{"require":false,"value":"e276abec-e0f2-11e3-8169-6d9ed49b625f","name":"domainUUID","des":""}],"output":[{"value":"$(UUIDList)","name":"$(UUIDList)","des":""},{"value":"$(NoList)","name":"$(NoList)","des":""},{"value":"$(NameList)","name":"$(NameList)","des":""},{"value":"$(SourceList)","name":"$(SourceList)","des":""},{"value":"$(DestinationList)","name":"$(DestinationList)","des":""},{"value":"$(PortList)","name":"$(PortList)","des":""},{"value":"$(JSONList)","name":"$(JSONList)","des":""}],"calculate":[],"packages":[],"code":"import requests\nimport json\nfrom omflow.syscom.tools import OmData\n\ndef get_api_token(host_ip, username, passwd):\n    '''\n    取得API Token，使用API必須之事前作業。不直接回傳response，取出三個重要資訊再回傳。\n    :param host_ip:\n    :param username:\n    :param passwd:\n    :return: dict(), 'X-auth-access-token', 'X-auth-refresh-token', 'DOMAIN_UUID'\n    '''\n    url = f\"https://{host_ip}/api/fmc_platform/v1/auth/generatetoken\"  # 取得token網址，見手冊第17頁\n    response = requests.post(url, auth=(username, passwd), verify=False)\n    # print(response)  # 正常應為204\n    message = response.headers\n    Access_token = message['X-auth-access-token']\n    Refresh_token = message['X-auth-refresh-token']\n    Domain_uuid = message['DOMAIN_UUID']\n    return {'X-auth-access-token': Access_token,\n            'X-auth-refresh-token': Refresh_token,\n            'DOMAIN_UUID': Domain_uuid}\n\n\ndef create_ticket(data):\n    # 宣告一個流程的物件\n    api_path = '5e3c4a58-f390-5959-8e37-5ff16a64d573'  # FMC Object Management\n    inc_flow_obj = OmData(api_path)\n\n    # 填入表單資料(非必要，視流程需求)\n    inc_flow_obj.setFormData('formitm_1', data['name'])  # name\n    inc_flow_obj.setFormData('formitm_2', data['type'])  # type\n    inc_flow_obj.setFormData('formitm_3', data['selfLink'])  # self link\n    inc_flow_obj.setFormData('formitm_4', data['parentLink'])  # parent link\n    inc_flow_obj.setFormData('formitm_5', data['id'])  # id\n    inc_flow_obj.setFormData('formitm_6', data['詳細資料'])  # 詳細資料(JSON)\n\n    # 送出開單\n    user_id = '1'  # 使用者編號\n    files = None  # 檔案\n    return inc_flow_obj.create(user_id, files)\n\n\n#host = '192.168.1.50'\n#username = 'apiadmin'\n#password = '1qaz@WSX'\n\ntoken = get_api_token(host, username, password)\n# print(token)\nhost_ip = host\nbase_url = f\"https://{host_ip}\"\n#domainUUID = \"e276abec-e0f2-11e3-8169-6d9ed49b625f\"\ncontainerUUID = \"000C29EB-DAD3-0ed3-0000-008589934595\"\napi_url = f'/api/fmc_config/v1/domain/{domainUUID}/policy/accesspolicies/{containerUUID}/accessrules?expanded=true'\n\nheaders_token = {'X-auth-access-token': token['X-auth-access-token']}\nres = requests.get(url=base_url+api_url, headers=headers_token, verify=False).json()\n\n\nUUIDList = []\nNoList = []\nNameList = []\nSourceList = []\nDestinationList = []\nPortList = []\nJSONList = []\nfor rule in res['items']:\n    try:\n        UUIDList.append(rule['id'])\n        NoList.append(rule['metadata']['ruleIndex'])\n        NameList.append(rule['name'])\n        JSONList.append(str(rule))\n        try:\n            temp = ''\n            for ele in rule['sourceNetworks']['objects']:\n                if temp:\n                    temp = temp + ' ' + ele['name']\n                else:\n                    temp = ele['name']\n            SourceList.append(temp)\n        except:\n            SourceList.append('')\n            \n        try:\n            temp = ''\n            for ele in rule['destinationNetworks']['objects']:\n                if temp:\n                    temp = temp + ' ' + ele['name']\n                else:\n                    temp = ele['name']\n            DestinationList.append(temp)\n        except:\n            DestinationList.append('')\n            \n        try:\n            temp = ''\n            for ele in rule['destinationPorts']['objects']:\n                if temp:\n                    temp = temp + ' ' + ele['name']\n                else:\n                    temp = ele['name']\n            PortList.append(temp)\n        except:\n            PortList.append('')\n    except Exception as e:\n        print(e)\n\nprint(res)\n","top":100,"left":570,"collector":null,"autoinstall":false}},{"id":"FLINE_MW4","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_5","source_item":"FITEM_1","idcounter":4,"linebox_left":630,"linebox_top":100,"linebox_long":0,"linebox_top_width":20,"linebox_bottom_width":-20,"linebox_arrow_top":110,"linebox_arrow_left":626}},{"id":"FLINE_MH6","type":"line","config":{"target_side":"right","source_side":"right","target_item":"FITEM_5","source_item":"FITEM_2","idcounter":6,"linebox_left":970,"linebox_top":150,"linebox_long":675,"linebox_top_width":280,"linebox_bottom_width":100,"linebox_arrow_top":146,"linebox_arrow_left":690}},{"id":"FITEM_7","type":"dyasync","text":"動態並行","left":0,"top":0,"config":{"route":"$(UUIDList)","route_type":"array","output":[{"value":"$(UUIDList)","name":"$(UUID)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(NoList)","name":"$(No)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(NameList)","name":"$(Name)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(SourceList)","name":"$(Source)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(DestinationList)","name":"$(Destination)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(PortList)","name":"$(Port)","des":"選擇要輸入並分解的陣列格式變數"},{"value":"$(JSONList)","name":"$(JSON)","des":"選擇要輸入並分解的陣列格式變數"}],"log":true,"top":200,"left":570}},{"id":"FLINE_MW7","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_7","source_item":"FITEM_5","idcounter":7,"linebox_left":630,"linebox_top":200,"linebox_long":0,"linebox_top_width":20,"linebox_bottom_width":-20,"linebox_arrow_top":210,"linebox_arrow_left":626}},{"id":"FITEM_8","type":"dycollection","text":"動態匯集","left":0,"top":0,"config":{"output":[],"log":true,"json":false,"isreplace":false,"replace_string":"","top":675,"left":570}},{"id":"FITEM_11","type":"inflow","text":"查詢防火牆規則表","left":0,"top":0,"config":{"error_pass":false,"log":true,"flow_name":"查詢防火牆規則表[Access_Rule]","subflow_input":[{"require":false,"value":"$(result)","name":"$(result)","des":""},{"require":false,"value":"$(UUID)","name":"$(UUID)","des":""},{"require":false,"value":null,"name":"$(No)","des":""},{"require":false,"value":null,"name":"$(Name)","des":""},{"require":false,"value":null,"name":"$(Source)","des":""},{"require":false,"value":null,"name":"$(Destination)","des":""},{"require":false,"value":null,"name":"$(Port)","des":""},{"require":false,"value":null,"name":"$(VPN)","des":""},{"require":false,"value":null,"name":"$(ServiceApplications)","des":""},{"require":false,"value":null,"name":"$(Action)","des":""},{"require":false,"value":null,"name":"$(Status)","des":""},{"require":false,"value":null,"name":"$(InstallOn)","des":""},{"require":false,"value":null,"name":"$(JSON)","des":""}],"subflow_output":[{"value":"$(result)","name":"$(result)","des":""},{"value":"$(data_no)","name":"$(data_no)","des":""},{"value":"$(objectJson)","name":"$(objectJson)","des":""}],"top":300,"left":570}},{"id":"FLINE_MW11","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_11","source_item":"FITEM_7","idcounter":11,"linebox_left":630,"linebox_top":300,"linebox_long":0,"linebox_top_width":20,"linebox_bottom_width":-20,"linebox_arrow_top":310,"linebox_arrow_left":626}},{"id":"FITEM_12","type":"switch","text":"判斷data no","left":0,"top":0,"config":{"calculate":[],"rules":[{"target":"FITEM_13","value1":"$(data_no)","value2":null,"rule":"!="},{"target":"FITEM_15","value1":"$(data_no)","value2":null,"rule":"="}],"log":true,"top":400,"left":390}},{"id":"FITEM_13","type":"switch","text":"判斷json","left":0,"top":0,"config":{"calculate":[],"rules":[{"target":"FITEM_8","value1":"$(objectJson)","value2":"$(JSON)","rule":"="},{"target":"FITEM_14","value1":"$(objectJson)","value2":"$(JSON)","rule":"!="}],"log":true,"top":500,"left":240}},{"id":"FLINE_MW14","type":"line","config":{"target_side":"top","source_side":"left","target_item":"FITEM_13","source_item":"FITEM_12","idcounter":14,"linebox_left":300,"linebox_top":450,"linebox_long":0,"linebox_top_width":90,"linebox_bottom_width":70,"linebox_arrow_top":510,"linebox_arrow_left":296}},{"id":"FITEM_14","type":"inflow","text":"進階推單防火牆規則表","left":0,"top":0,"config":{"error_pass":false,"log":true,"flow_name":"進階推單防火牆規則表[Access_Rule]","subflow_input":[{"require":false,"value":"$(result)","name":"$(result)","des":""},{"require":false,"value":"$(UUID)","name":"$(UUID)","des":""},{"require":false,"value":"$(No)","name":"$(No)","des":""},{"require":false,"value":"$(Name)","name":"$(Name)","des":""},{"require":false,"value":"$(Source)","name":"$(Source)","des":""},{"require":false,"value":"$(Destination)","name":"$(Destination)","des":""},{"require":false,"value":"$(Port)","name":"$(Port)","des":""},{"require":false,"value":null,"name":"$(VPN)","des":""},{"require":false,"value":null,"name":"$(ServiceApplications)","des":""},{"require":false,"value":null,"name":"$(Action)","des":""},{"require":false,"value":null,"name":"$(Status)","des":""},{"require":false,"value":null,"name":"$(InstallOn)","des":""},{"require":false,"value":"$(JSON)","name":"$(JSON)","des":""}],"subflow_output":[{"value":"$(result)","name":"$(result)","des":""}],"top":675,"left":90}},{"id":"FLINE_MW16","type":"line","config":{"target_side":"top","source_side":"left","target_item":"FITEM_14","source_item":"FITEM_13","idcounter":16,"linebox_left":150,"linebox_top":550,"linebox_long":0,"linebox_top_width":90,"linebox_bottom_width":145,"linebox_arrow_top":685,"linebox_arrow_left":146}},{"id":"FLINE_MH17","type":"line","config":{"target_side":"left","source_side":"right","target_item":"FITEM_8","source_item":"FITEM_14","idcounter":17,"linebox_left":390,"linebox_top":725,"linebox_long":0,"linebox_top_width":180,"linebox_bottom_width":-180,"linebox_arrow_top":721,"linebox_arrow_left":560}},{"id":"FITEM_15","type":"inflow","text":"新增防火牆規則表","left":0,"top":0,"config":{"error_pass":false,"log":true,"flow_name":"建立防火牆規則表[Access_Rule]","subflow_input":[{"require":false,"value":"$(result)","name":"$(result)","des":""},{"require":false,"value":"$(UUID)","name":"$(UUID)","des":""},{"require":false,"value":"$(No)","name":"$(No)","des":""},{"require":false,"value":"$(Name)","name":"$(Name)","des":""},{"require":false,"value":"$(Source)","name":"$(Source)","des":""},{"require":false,"value":"$(Destination)","name":"$(Destination)","des":""},{"require":false,"value":"$(Port)","name":"$(Port)","des":""},{"require":false,"value":null,"name":"$(VPN)","des":""},{"require":false,"value":null,"name":"$(ServiceApplications)","des":""},{"require":false,"value":null,"name":"$(Action)","des":""},{"require":false,"value":null,"name":"$(Status)","des":""},{"require":false,"value":null,"name":"$(InstallOn)","des":""},{"require":false,"value":"$(JSON)","name":"$(JSON)","des":""}],"subflow_output":[{"value":"$(result)","name":"$(result)","des":""}],"top":500,"left":570}},{"id":"FLINE_MW18","type":"line","config":{"target_side":"top","source_side":"right","target_item":"FITEM_15","source_item":"FITEM_12","idcounter":18,"linebox_left":630,"linebox_top":450,"linebox_long":0,"linebox_top_width":-120,"linebox_bottom_width":70,"linebox_arrow_top":510,"linebox_arrow_left":626}},{"id":"FLINE_MW21","type":"line","config":{"target_side":"top","source_side":"left","target_item":"FITEM_12","source_item":"FITEM_11","idcounter":21,"linebox_left":450,"linebox_top":350,"linebox_long":0,"linebox_top_width":120,"linebox_bottom_width":70,"linebox_arrow_top":410,"linebox_arrow_left":446}},{"id":"FLINE_MH23","type":"line","config":{"target_side":"right","source_side":"bottom","target_item":"FITEM_8","source_item":"FITEM_15","idcounter":23,"linebox_left":630,"linebox_top":725,"linebox_long":0,"linebox_top_width":60,"linebox_bottom_width":-145,"linebox_arrow_top":721,"linebox_arrow_left":690}},{"id":"FLINE_MW24","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_8","source_item":"FITEM_13","idcounter":24,"linebox_left":300,"linebox_top":637.5,"linebox_long":330,"linebox_top_width":-57.5,"linebox_bottom_width":57.5,"linebox_arrow_top":685,"linebox_arrow_left":626}},{"id":"FLINE_MW25","type":"line","config":{"target_side":"top","source_side":"bottom","target_item":"FITEM_4","source_item":"FITEM_8","idcounter":25,"linebox_left":630,"linebox_top":825,"linebox_long":0,"linebox_top_width":70,"linebox_bottom_width":-70,"linebox_arrow_top":885,"linebox_arrow_left":626}}],"version":16777216,"wnd_height":1012,"uid":1671072607657},"config":{"subflow":[],"permission":[],"datafilter":false,"datafilter_config":{"matchAll":{"users":[],"groups":[],"roles":[]},"matchProfile":[],"matchFormdata":[]},"static":false,"name":"掃描防火牆規則[Access_Rule]","description":"","api_path":"dbb7afd1-4aaf-c47c-9880-da405c12266a","fp_show":true,"attachment":false,"relation":false,"worklog":false,"history":true,"mission":true,"flowlog":true,"api":true,"check_ticket":false,"title_field":0,"status_field":0,"display_field":0,"search_field":0,"custom_data_no":{"enable":false,"custom_data_no_str":"","custom_data_no_date":"","custom_data_no_len":"8","custom_data_no_twy":"0","custom_data_no_reset":"no"}},"flow_app_id__app_name":"OMFLOW CISCO FirePower APP"}]}]